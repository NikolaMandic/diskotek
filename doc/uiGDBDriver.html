<!DOCTYPE html><html lang="en"><head><title>uiGDBDriver</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="uiGDBDriver"><meta name="groc-project-path" content="app/scripts/uiGDBDriver.js"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path">app/scripts/uiGDBDriver.js</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>Generated by CoffeeScript 1.6.3</p></div></div><div class="code"><div class="wrapper"><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;ldApp&#39;</span><span class="p">).</span><span class="nx">factory</span><span class="p">(</span><span class="s1">&#39;uiGDBDriver&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;$rootScope&#39;</span><span class="p">,</span> <span class="s1">&#39;command&#39;</span><span class="p">,</span> <span class="s1">&#39;DataDebug&#39;</span><span class="p">,</span> <span class="s1">&#39;DataDisassembly&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$rootScope</span><span class="p">,</span> <span class="nx">command</span><span class="p">,</span> <span class="nx">DataDebug</span><span class="p">,</span> <span class="nx">DataDisassembly</span><span class="p">)</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>#</p></div></div><div class="code"><div class="wrapper">      <span class="kd">var</span> <span class="nx">obj</span><span class="p">;</span>
      <span class="k">return</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>start command is going to start qemu user emulator that will 
run this target and wait for a debuger to attach on 12345 port 
also it will start gdb that will load target from disk and then
commands set arch arm will be sent to the gdb
and target remote command to connect to the emulator</p></div></div><div class="code"><div class="wrapper">        <span class="nx">loadCommand</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">architecture</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">command</span><span class="p">.</span><span class="nx">commandExecO</span><span class="p">({</span>
            <span class="nx">msgType</span><span class="o">:</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span>
            <span class="nx">payload</span><span class="o">:</span> <span class="p">{</span>
              <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
              <span class="nx">architecture</span><span class="o">:</span> <span class="nx">architecture</span><span class="p">,</span>
              <span class="nx">initSteps</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;set disassembly-flavor intel\n&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="nx">callback</span><span class="o">:</span> <span class="kc">null</span>
          <span class="p">});</span>
        <span class="p">},</span>
        <span class="nx">startCommand</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">architecture</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">command</span><span class="p">.</span><span class="nx">commandExecO</span><span class="p">({</span>
            <span class="nx">msgType</span><span class="o">:</span> <span class="s1">&#39;start&#39;</span><span class="p">,</span>
            <span class="nx">payload</span><span class="o">:</span> <span class="p">{</span>
              <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
              <span class="nx">architecture</span><span class="o">:</span> <span class="nx">architecture</span><span class="p">,</span>
              <span class="nx">initSteps</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;set disassembly-flavor intel\n&#39;</span><span class="p">,</span> <span class="s1">&#39;break _start\n&#39;</span><span class="p">,</span> <span class="s1">&#39;run\n&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="nx">callback</span><span class="o">:</span> <span class="kc">null</span>
          <span class="p">});</span>
          <span class="nx">obj</span><span class="p">.</span><span class="nx">debugData</span><span class="p">.</span><span class="nx">getDissasembly</span><span class="p">();</span>
          <span class="nx">obj</span><span class="p">.</span><span class="nx">debugData</span><span class="p">.</span><span class="nx">getRegisterInfo</span><span class="p">();</span>
          <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">debugData</span><span class="p">.</span><span class="nx">infoBreakpoints</span><span class="p">();</span>
        <span class="p">},</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>stop command will send command to the gdb that will detach the debugger
qemu emulator exits at that point
then a quit command is sent and gdb exits</p></div></div><div class="code"><div class="wrapper">        <span class="nx">stop</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="nx">command</span><span class="p">.</span><span class="nx">commandExecO</span><span class="p">({</span>
            <span class="nx">ptyPayload</span><span class="o">:</span> <span class="s1">&#39;detach&#39;</span><span class="p">,</span>
            <span class="nx">callback</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
              <span class="nx">obj</span><span class="p">.</span><span class="nx">debugData</span><span class="p">.</span><span class="nx">status</span> <span class="o">=</span> <span class="s1">&#39;detached&#39;</span><span class="p">;</span>
              <span class="nx">obj</span><span class="p">.</span><span class="nx">debugData</span><span class="p">.</span><span class="nx">registers</span> <span class="o">=</span> <span class="p">[];</span>
              <span class="k">return</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="p">}</span>
          <span class="p">});</span>
          <span class="k">return</span> <span class="nx">command</span><span class="p">.</span><span class="nx">commandExecO</span><span class="p">({</span>
            <span class="nx">ptyPayload</span><span class="o">:</span> <span class="s1">&#39;quit&#39;</span><span class="p">,</span>
            <span class="nx">callback</span><span class="o">:</span> <span class="kc">null</span>
          <span class="p">});</span>
        <span class="p">}</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">]);</span>

<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></div></div></div></div></body></html>